webpackJsonp([1],{236:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o,r,u,f,d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(2),h=a(c),p=n(15),m=a(p),y=n(169),b=a(y),v=n(49),g=function(e){function t(e){i(this,t);var n=l(this,Object.getPrototypeOf(t).call(this,e));return n.state={count:0,ask:"",nextask:"",answer:""},n.toggle=n.toggle.bind(n),n.timerOn=n.timerOn.bind(n),n.timerOff=n.timerOff.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n.handleNextAskChange=n.handleNextAskChange.bind(n),n}return s(t,e),d(t,[{key:"loadajax",value:function(e){f=new XMLHttpRequest,f.open("GET","http://www.paljaat.fi:8000/chat/"+e,!0),f.onload=function(){if(f.status>=200&&f.status<400){var e=JSON.parse(f.responseText);this.setState({answer:e.answer})}}.bind(this),f.onerror=function(){},f.send()}},{key:"timerOff",value:function(){clearInterval(o),o=0,this.setState({count:0})}},{key:"timerOn",value:function(){var e=this;o=setInterval(function(){e.setState({count:e.state.count+1})},3500)}},{key:"toggle",value:function(){var e=m["default"].findDOMNode(this.refs.label_typing);"hidden"===e.style.visibility?e.style.visibility="":e.style.visibility="hidden"}},{key:"componentWillReceiveProps",value:function(e){if(r=e.data,this.setState({ask:"Hei "+r.Name+"!"}),"on"===e.timerHandler){m["default"].findDOMNode(this.refs.answer).style.display="none",u=b["default"].v4();var t=u+"/"+r.Phone+"/"+encodeURIComponent(this.state.ask);this.loadajax(encodeURIComponent(t)),this.timerOn()}else console.log("STOP timeR"),this.timerOff()}},{key:"componentWillUpdate",value:function(e){this.state.count>7?(m["default"].findDOMNode(this.refs.label_typing).style.visibility="hidden",m["default"].findDOMNode(this.refs.answer).style.display="",this.timerOff()):0!==this.state.count&&this.toggle()}},{key:"componentDidUpdate",value:function(e,t){}},{key:"componentWillMount",value:function(){this.setState({nextask:""}),this.setState({ask:""})}},{key:"componentDidMount",value:function(){r=this.props.data,this.setState({ask:"Hei "+r.Name+"!"});var e=m["default"].findDOMNode(this.refs.answer);e.style.display="none"}},{key:"componentWillUnmount",value:function(){console.log("componentWillUnmount Chat",f),this.timerOff()}},{key:"handleSubmit",value:function(e){if(this.state.nextask.length>0){e.preventDefault(),console.log(this.state.nextask),this.state.ask=this.state.nextask.trim(),this.state.nextask="",m["default"].findDOMNode(this.refs.answer).style.display="none",this.timerOn();var t=u+"/"+r.Phone+"/"+encodeURIComponent(this.state.ask);this.loadajax(encodeURIComponent(t))}}},{key:"handleNextAskChange",value:function(e){this.setState({nextask:e.target.value})}},{key:"render",value:function(){var e=this.props.data,t="odotta",n=this.state.answer,a=this.state.ask;return this.state.count>2&&(t="delivered"),this.state.count>5&&(t="seen"),this.state.count>7&&(t="typing"),h["default"].createElement("div",null,h["default"].createElement("p",null,h["default"].createElement("a",{className:"mbigphone",href:"tel:"+e.Phone},h["default"].createElement("span",{className:"glyphicon glyphicon-earphone","aria-hidden":"true"}),e.Phone)),"Chatti: ",e.Name," ",e.Age,"v",h["default"].createElement(v.Badge,{ref:"label_typing",pullRight:!0},t),h["default"].createElement("p",null),h["default"].createElement(v.Alert,null,a),h["default"].createElement("div",{ref:"answer"},h["default"].createElement(v.Alert,{bsStyle:"danger"},n),h["default"].createElement("form",{onSubmit:this.handleSubmit},h["default"].createElement(v.Input,{type:"text",label:"Name",placeholder:"Kysy√§ jotain!",value:this.state.nextask,onChange:this.handleNextAskChange})),h["default"].createElement(v.Button,{bsStyle:"primary",onClick:this.handleSubmit},"Jatkaa")))}}]),t}(h["default"].Component);e.exports=g},237:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(2),u=a(r),f=n(49),d=n(73),c=n(15),h=a(c),p=n(236),m=a(p),y=function(e){function t(e){i(this,t);var n=l(this,Object.getPrototypeOf(t).call(this,e));return n.state={data:[],timerHandler:""},n.handleToggleDetailsChat=n.handleToggleDetailsChat.bind(n),n}return s(t,e),o(t,[{key:"loadajax",value:function(e){var t=location.hostname;"127.0.0.1"==t&&(t="www.test.com");var n=new XMLHttpRequest;n.open("GET","http://"+t+":8000/api/"+e,!0),n.onload=function(){if(n.status>=200&&n.status<400){var e=JSON.parse(n.responseText);this.setState({data:e})}}.bind(this),n.onerror=function(){},n.send()}},{key:"handleToggleDetailsChat",value:function(){var e=h["default"].findDOMNode(this.refs.chat).style.display;"none"===e?(this.setState({timerHandler:"on"}),h["default"].findDOMNode(this.refs.chat).style.display="",h["default"].findDOMNode(this.refs.details).style.display="none"):(this.setState({timerHandler:"off"}),h["default"].findDOMNode(this.refs.chat).style.display="none",h["default"].findDOMNode(this.refs.details).style.display="")}},{key:"handleReturn",value:function(){d.browserHistory.push("/")}},{key:"componentWillMount",value:function(){this.loadajax(this.props.params.id)}},{key:"componentDidMount",value:function(){h["default"].findDOMNode(this.refs.chat).style.display="none"}},{key:"componentWillReceiveProps",value:function(){}},{key:"componentWillUpdate",value:function(e){}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this.state.data,t="http://www.paljaat.fi:8000/img/"+e.ImgId+"/"+e.Img_file_name+"/250/350";return u["default"].createElement("div",null,u["default"].createElement(f.Button,{onClick:this.handleReturn,className:"bigclose",bsStyle:"danger",bsSize:"large",active:!0},"Palata"),u["default"].createElement("div",{ref:"details"},u["default"].createElement(f.Label,{bsStyle:"danger",bsClass:"mbigphone"},u["default"].createElement("span",{className:"glyphicon glyphicon-earphone","aria-hidden":"true"})," ",e.Phone),u["default"].createElement("div",{className:"media "},u["default"].createElement("div",{className:"media-left "},u["default"].createElement(f.Image,{className:"media-object boxImageSmall",src:t,thumbnail:!0})),u["default"].createElement("div",{className:"media-body"},u["default"].createElement("p",{className:"detailsname"},e.Name," ",this.state.data.Age,"v "),u["default"].createElement("p",null,e.City),u["default"].createElement(f.Button,{onClick:this.handleToggleDetailsChat,bsStyle:"primary",bsSize:"large",active:!0},"Chatti")))),u["default"].createElement("div",{ref:"chat"},u["default"].createElement(m["default"],{data:e,timerHandler:this.state.timerHandler})),u["default"].createElement("p",{className:"transparent"},e.Description))}}]),t}(u["default"].Component);e.exports=y}});